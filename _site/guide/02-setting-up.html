


<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
	<title>A Guide to the Electric Book Workflow: Setting up</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" media="screen" href="/electric-book-workflow/css/web.css" />
	<link rel="stylesheet" type="text/css" media="print" href="../css/print.css" />

	<!-- Google Analytics, runs unless this is running through PrinceXML -->
	<script>
		if (typeof Prince  === "undefined") {
			<!--Paste any Google Analytics code here. The surrounding if statement stops the script slowing down PrinceXML-->
		}
	</script>

</head>
<body class="chapter">




		<div id="nav-bar" class="non-printing">
			<p>
				<a href="/electric-book-workflow/" title="Home: Electric Book Workflow" class="nav-series">Electric Book Workflow</a>
				<a href="0-3-contents.html" title="A Guide to the Electric Book Workflow" class="nav-book">A Guide to the Electric Book Workflow</a>
				<a href="" title="Top: Setting up"  class="nav-page">Setting up</a>
			</p>
		</div><!--#nav-bar-->

	<div id="wrapper">


<h1 class="no_toc" id="setting-up">Setting up</h1>

<ul id="markdown-toc">
  <li><a href="#technical-overview" id="markdown-toc-technical-overview">Technical overview</a></li>
  <li><a href="#example-bettercare" id="markdown-toc-example-bettercare">Example: Bettercare</a></li>
  <li><a href="#folder-repo-structure" id="markdown-toc-folder-repo-structure">Folder (repo) structure</a></li>
  <li><a href="#using-the-template" id="markdown-toc-using-the-template">Using the template</a></li>
  <li><a href="#creating-a-new-book" id="markdown-toc-creating-a-new-book">Creating a new book</a></li>
  <li><a href="#creating-book-content" id="markdown-toc-creating-book-content">Creating book content</a>    <ul>
      <li><a href="#set-first-pages" id="markdown-toc-set-first-pages">Set first pages</a></li>
      <li><a href="#file-naming" id="markdown-toc-file-naming">File naming</a></li>
    </ul>
  </li>
  <li><a href="#the-images-folder" id="markdown-toc-the-images-folder">The <code class="highlighter-rouge">images</code> folder</a></li>
</ul>

<h2 id="technical-overview">Technical overview</h2>

<p>To set up the workflow, you still have to have some technical expertise. Once it’s set up, non-technical editorial team members with a couple of hours training (taught or self-taught) can add and edit books in it.</p>

<p>The technical team members who run the workflow need to be familiar with a few concepts and tools:</p>

<ul>
  <li><strong>HTML and CSS</strong>: the fundamental building blocks of almost all digital content.</li>
  <li><strong>Markdown</strong>: a simple, plain-text shortcut for creating HTML. (The original <a href="http://daringfireball.net/projects/markdown/syntax">Markdown syntax reference</a> is the easiest intro to basic markdown. We use a markdown variant called <a href="http://kramdown.gettalong.org">kramdown</a>, because it’s GitHub’s default and it supports attributes like classes.)</li>
  <li><strong>Sass</strong>: a way to create complex CSS from simple rules.</li>
  <li><strong>Jekyll</strong>: software that turns markdown and Sass into HTML and CSS. (To learn about Jekyll, <a href="http://jekyllrb.com/">start here</a>. If you’re installing it on Windows, <a href="http://jekyll-windows.juthilo.com/">you’ll also need this guide</a>.)</li>
  <li><strong>Git</strong>: software for tracking a team’s changes and syncing them with a remote server. We like to use <a href="http://github.com">GitHub</a> and <a href="http://bitbucket.org">Bitbucket</a> as our remotes.</li>
  <li><strong>Sigil</strong>: an open-source epub editor, where we quickly assemble ebooks.</li>
  <li><strong>PrinceXML</strong>: an app for creating PDFs from HTML and CSS (Prince is the only proprietary part of this stack).</li>
</ul>

<blockquote>
  <h2 id="example-bettercare">Example: Bettercare</h2>

  <p>Bettercare publishes nursing textbooks. The team uses the workflow to keep a book’s master content in markdown files, structured for Jekyll, on GitHub. For instance, Bettercare’s books are stored here: <a href="https://github.com/bettercarehealth/bettercare">https://github.com/bettercarehealth/bettercare</a></p>

  <blockquote class="box">
    <p>Note: Bettercare is a great example of a big publishing project using the workflow. However, since it was our first full implementation, it uses an early, outdated version of the workflow.</p>
  </blockquote>

  <p>The workflow uses the <a href="http://kramdown.gettalong.org/">kramdown syntax</a> for markdown, in part because that’s what GitHub uses and largely because it has specific features we need, such as classes (with ‘inline attribute lists’ or IALs).</p>

  <p>For Bettercare’s open-source books, we let GitHub Pages publish the static HTML output, which it does automatically, also with Jekyll. For instance, our staging site for Bettercare content is here: <a href="http://bettercarehealth.github.io/bettercare/">http://bettercarehealth.github.io/bettercare/</a></p>

  <p>Bettercare then copies the output HTML to a <a href="http://ls.bettercare.co.za">separate, production site</a>.</p>

  <p>When we use this workflow for closed content, we don’t use GitHub Pages, and store the content in private GitHub or Bitbucket repos instead.</p>

  <p>If you click through to a book chapter available on the web, you’ll see the HTML we get from kramdown is very neat. For example, view source here: <a href="http://bettercarehealth.github.io/bettercare/nc/nc-1.html">http://bettercarehealth.github.io/bettercare/nc/nc-1.html</a></p>

  <p>The key to simple HTML is in carefully <a href="http://electricbookworks.com/kb/creating-epub-from-indesign/mapping-book-features-to-html-elements-and-classes/">mapping a book’s features</a> to ordinary HTML elements. That way, we need only a few classes, and can easily use the same HTML with simple stylesheets for the web, apps, epub, and print output. And our HTML content remains readable in readers and low-bandwidth browsers with low CSS support.</p>

  <p>Finally, to turn our HTML into print PDFs, we use <a href="http://princexml.com">PrinceXML</a>. And we use Sigil to put our HTML into EPUB2-valid epubs. This way, we can create print PDFs or epubs in a  matter of minutes.</p>
</blockquote>

<h2 id="folder-repo-structure">Folder (repo) structure</h2>

<p>A workflow folder (often tracked in Git as a repo) usually contains a series of related books. Its folders and files follow the <a href="http://jekyllrb.com/docs/structure/">standard Jekyll structure</a>: in the root are <code class="highlighter-rouge">_include</code>, <code class="highlighter-rouge">_layouts</code> and <code class="highlighter-rouge">css</code> folders, and <code class="highlighter-rouge">_config.yml</code> and <code class="highlighter-rouge">index</code> files. We then put each book’s content in its own folder.</p>

<blockquote class="box">
  <p>Pro tip: You could also store several series in one repo, each series with its own set of Jekyll files, and a single <code class="highlighter-rouge">_prose.yml</code> configuration in the root folder for all series subfolders. This is only useful if you don’t need a live staging site or previews with GitHub Pages, since each Jekyll setup must be in its own repo for GitHub Pages to work out of the box.</p>
</blockquote>

<h2 id="using-the-template">Using the template</h2>

<p>The <code class="highlighter-rouge">template</code> folder is a ready-to-use workflow folder for making books. In the <code class="highlighter-rouge">template</code> folder, there are several folders and files:</p>

<ul>
  <li><code class="highlighter-rouge">book</code>: book content files</li>
  <li><code class="highlighter-rouge">css</code>: book design files</li>
  <li><code class="highlighter-rouge">_includes</code>: snippets of HTML for Jekyll (you won’t have to open this folder)</li>
  <li><code class="highlighter-rouge">_layouts</code>: instructions to Jekyll on how to assemble those snippets (no need to open this either)</li>
  <li><code class="highlighter-rouge">_data</code>: files containing book metadata</li>
  <li><code class="highlighter-rouge">_config.yml</code>: a file for setting configuration options for your collection of books</li>
  <li><code class="highlighter-rouge">_prose.yml</code>: configuration settings for using <a href="http://prose.io">prose.io</a> for online book editing (generally, you won’t have to edit this)</li>
  <li><code class="highlighter-rouge">index.md</code>: content for the home page of your collection when served as a website.</li>
</ul>

<p>The <code class="highlighter-rouge">book</code> folder is an example book with a minimum number of sample files in it.</p>

<p>The files in the <code class="highlighter-rouge">css</code> folder handle the design of your books. It contains a theme that we call ‘Classic’. A theme is a collection of CSS (Sass, technically) files that define a book’s design. We hope that in future we and others might design other themes, though Classic is extremely versatile already. For most book design, you’ll only have to edit the variables in your own copies of <code class="highlighter-rouge">print.scss</code>, <code class="highlighter-rouge">web.scss</code> and <code class="highlighter-rouge">epub.scss</code>.</p>

<blockquote class="box">
  <p>Technical note: If you’re familiar with Sass, you’ll know that Jekyll’s will convert these <code class="highlighter-rouge">.scss</code> files into finished <code class="highlighter-rouge">.css</code> files. Sass, saved in <code class="highlighter-rouge">.scss</code> files, is to CSS what markdown is to HTML: an efficient way to write that lets software do the hard work of creating finished code.</p>
</blockquote>

<h2 id="creating-a-new-book">Creating a new book</h2>

<p>To create a new book in a new series:</p>

<ol>
  <li>The <code class="highlighter-rouge">template</code> folder can hold one book or many, like a collection of books that share similar metadata or features (e.g. they’re all by the same publisher). Make a copy of <code class="highlighter-rouge">template</code> and rename it for your collection. E.g. <code class="highlighter-rouge">my-sci-fi</code>.</li>
  <li>Rename the <code class="highlighter-rouge">book</code> folder with a short folder-name version of your book’s title. Use only lowercase letters and no spaces. If you’re creating more than one book, make a copy of this folder for each one. Each book gets its own folder. The name of the folder is important: you will use this folder name as the book’s ‘slug’, a sort of human-readable identifier within a series folder.</li>
  <li>Inside a book’s folder, add a markdown file for each piece of your book, e.g. one file per chapter. Our template contains files we consider minimum requirements for most books: a cover, a title page, a copyright page, a contents page, and a text file.</li>
  <li>Inside each book’s folder, store images in the <code class="highlighter-rouge">images</code> folder. Add a <code class="highlighter-rouge">cover.jpg</code> image of your book’s front cover there, too.</li>
  <li>In the <code class="highlighter-rouge">css</code> folder, make copies of <code class="highlighter-rouge">print.scss</code>, <code class="highlighter-rouge">web.scss</code> and <code class="highlighter-rouge">epub.scss</code> and rename them for each book (e.g. <code class="highlighter-rouge">print-space-potatoes.scss</code>).</li>
  <li>Inside <code class="highlighter-rouge">my-sci-fi</code>, open and edit these three files:
    <ul>
      <li><code class="highlighter-rouge">_config.yml</code>: Edit the values there for your series. The comments will guide you.</li>
      <li><code class="highlighter-rouge">index.md</code>: Replace our template text with your own. Usually, at least a link to each book is useful, e.g. <code class="highlighter-rouge">[Space Potatoes](space-potatoes)</code>.</li>
      <li><code class="highlighter-rouge">README.md</code>: Replace our template text with any notes your collaborators might need to know about your series. (The README file is usually only read in the context of editing the files in your folder/repo.)</li>
    </ul>
  </li>
  <li>In <code class="highlighter-rouge">_data</code>, make a copy of the <code class="highlighter-rouge">book.yml</code> file to edit. Give the file the same name as your book’s slug. In this example, that would be <code class="highlighter-rouge">my-sci-fi.yml</code>. In that file, fill in as much metadata as you can. (Your markdown files and HTML snippets will draw on that metadata, using Liquid tags, when constructing your book.)</li>
</ol>

<h2 id="creating-book-content">Creating book content</h2>

<p>Each markdown file in <code class="highlighter-rouge">my-sci-fi</code> is a part of a book, such as a table of contents or a chapter. In each file’s YAML header (the info between <code class="highlighter-rouge">---</code>s at the top) we specify the book-part’s <code class="highlighter-rouge">title</code> and the book-part’s <code class="highlighter-rouge">style</code> to use for that part. The <code class="highlighter-rouge">style</code> specifies what kind of book-part it is, such as a <code class="highlighter-rouge">title-page</code> or <code class="highlighter-rouge">chapter</code>.</p>

<blockquote class="box">
  <p>Technical note: the <code class="highlighter-rouge">style</code> YAML sets the class attribute of the output HTML’s <code class="highlighter-rouge">&lt;body&gt;</code> element. We use that class to control CSS and page structure.</p>
</blockquote>

<p>When you create your book, we recommend following these conventions for file naming and <code class="highlighter-rouge">style</code> settings:</p>

<table>
  <thead>
    <tr>
      <th>Book section</th>
      <th>Sample file</th>
      <th>Style in YAML</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Front cover (for the ebook)</td>
      <td><code class="highlighter-rouge">0-0-cover.md</code></td>
      <td><code class="highlighter-rouge">cover</code></td>
    </tr>
    <tr>
      <td>Title page</td>
      <td><code class="highlighter-rouge">0-1-titlepage.md</code></td>
      <td><code class="highlighter-rouge">title-page</code></td>
    </tr>
    <tr>
      <td>Copyright page</td>
      <td><code class="highlighter-rouge">0-2-copyright.md</code></td>
      <td><code class="highlighter-rouge">copyright-page</code></td>
    </tr>
    <tr>
      <td>Table of contents</td>
      <td><code class="highlighter-rouge">0-3-contents.md</code></td>
      <td><code class="highlighter-rouge">contents-page</code></td>
    </tr>
    <tr>
      <td>Acknowledgements</td>
      <td><code class="highlighter-rouge">0-4-acknowledgements.md</code></td>
      <td><code class="highlighter-rouge">frontmatter</code></td>
    </tr>
    <tr>
      <td>A first chapter</td>
      <td><code class="highlighter-rouge">1.md</code></td>
      <td><code class="highlighter-rouge">chapter</code></td>
    </tr>
    <tr>
      <td>A second chapter</td>
      <td><code class="highlighter-rouge">2.md</code></td>
      <td><code class="highlighter-rouge">chapter</code></td>
    </tr>
  </tbody>
</table>

<p>If you don’t set the <code class="highlighter-rouge">style</code>, the page will default to <code class="highlighter-rouge">style: chapter</code>. So you actually don’t need to ever set <code class="highlighter-rouge">style: chapter</code> in a YAML header.</p>

<p>Page layouts we’ve designed for in the Classic theme include:</p>

<ul>
  <li><code class="highlighter-rouge">index</code> for the home page of a collection</li>
  <li><code class="highlighter-rouge">cover</code> for a front cover, which will appear in ebook editions</li>
  <li><code class="highlighter-rouge">halftitle-page</code> for a book’s halftitle page</li>
  <li><code class="highlighter-rouge">previous-publications-page</code> for a book’s list of the author’s previous publications</li>
  <li><code class="highlighter-rouge">title-page</code> for a book’s title page</li>
  <li><code class="highlighter-rouge">copyright-page</code> for the copyright or imprint page</li>
  <li><code class="highlighter-rouge">contents-page</code> for the book’s table of contents</li>
  <li><code class="highlighter-rouge">dedication-page</code> for a dedication page</li>
  <li><code class="highlighter-rouge">epigraph-page</code> for an epigraph page</li>
  <li><code class="highlighter-rouge">frontispiece-page</code> for a frontispiece page</li>
  <li><code class="highlighter-rouge">frontmatter</code> for other prelim pages not accounted for otherwise</li>
  <li><code class="highlighter-rouge">chapter</code> for a book’s default chapter page (and the global default)</li>
</ul>

<p>You can also invent your own page styles, and use them in your custom CSS instead of these, though you may get unexpected results if you’ve been relying on CSS for existing styles like <code class="highlighter-rouge">chapter</code>.</p>

<blockquote class="box">
  <p>Tip: If, in your web output, you don’t want the navigation (nav bar and footer) on a page, such as the collection’s index page, add <code class="highlighter-rouge">layout: min</code> to the document’s YAML header. The <code class="highlighter-rouge">min</code> layout does not include a nav-bar and footer.</p>
</blockquote>

<h3 id="set-first-pages">Set first pages</h3>

<p>Many books have two ‘page ones’:</p>

<ol>
  <li>the half-title or title page and,</li>
  <li>if the prelims have roman-numeral page numbers, the first chapter.</li>
</ol>

<p>You should specify those pages so that Prince knows where to start numbering.</p>

<p>Why? Well, for example, in print output if you use <code class="highlighter-rouge">frontmatter</code> on a book-part, by default it will have roman-numeral page numbers. When the first <code class="highlighter-rouge">chapter</code> starts, it will have decimal page numbers. However, the page numbering will be consecutive from roman through decimal. That is, it will run ‘ix, x, 11, 12’. You reset the numbering to 1 at the start of the first <code class="highlighter-rouge">chapter</code> to avoid this.</p>

<p>You reset page numbering by adding the class <code class="highlighter-rouge">page-1</code> to the first block-level element on the relevant page.</p>

<p>You can do this in two ways:</p>

<ol>
  <li>
    <p>If a markdown document starts at ‘page one’, add the class to the <code class="highlighter-rouge">style</code> YAML header. E.g.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>---
title: Half-title page
style: halftitle-page page-1
---
</code></pre>
    </div>

    <p>And at the first chapter:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>---
title: Chapter One
style: chapter page-1
---
</code></pre>
    </div>

    <p>Remember that <code class="highlighter-rouge">chapter</code> is the default, so you normally don’t have to specify it. <em>But</em> if you want to <em>add</em> a class in addition to <code class="highlighter-rouge">chapter</code>, you must specify both classes. This is because, if you were to use <code class="highlighter-rouge">style: page-1</code> in a YAML header, the class <code class="highlighter-rouge">page-1</code> would override the default <code class="highlighter-rouge">style: chapter</code>, not add to it.</p>
  </li>
  <li>
    <p>Add the <code class="highlighter-rouge">page-1</code> class to the first block-level element in the chapter by adding the tag <code class="highlighter-rouge"><span class="p">{</span><span class="err">:.page-1</span><span class="p">}</span></code> in the line immediately after it. (Note: for this to work, the element must <em>not</em> have a CSS float applied to it.)</p>
  </li>
</ol>

<h3 id="file-naming">File naming</h3>

<p>Name each book’s markdown files in perfectly alphabetical order. We recommend using a numbering system, where prelims (frontmatter) files start with a 0, e.g. <code class="highlighter-rouge">0-1-titlepage.md</code>, <code class="highlighter-rouge">0-2-copyright.md</code>, and chapter files are numbered for their chapter number, e.g. <code class="highlighter-rouge">01.md</code>, <code class="highlighter-rouge">02.md</code>, and so on. The alphabetical order makes it easy to see the documents in the right order at all times, and it makes ordering outputted HTML files easy when dropping them into Prince for PDF output.</p>

<blockquote class="box">
  <p>Note: We recommend using leading zeros in file-name numbers – that is, <code class="highlighter-rouge">02.md</code> rather than <code class="highlighter-rouge">2.md</code> – because that sorts correctly in most file browsers. Otherwise, some file browsers will sort <code class="highlighter-rouge">10.md</code> before <code class="highlighter-rouge">2.md</code>. In the rare event that you have over 99 chapters, use two leading zeros: <code class="highlighter-rouge">001.md</code>.</p>
</blockquote>

<h2 id="the-images-folder">The <code class="highlighter-rouge">images</code> folder</h2>

<p>Alongside the content files in a book’s folder is an <code class="highlighter-rouge">images</code> folder, for images that belong to that book only.</p>

<p>A book’s folder should only ever need to contain markdown files and images. If you’re embedding other kinds of media you could add folders for that alongside <code class="highlighter-rouge">images</code>. We don’t recommend sharing images or media between books, in case you want to move a book from one repo to another later. (So, for example, copy the publisher logo into each book’s <code class="highlighter-rouge">images</code> folder separately.)</p>


	</div><!--#wrapper-->
	

	<div id="footer" class="non-printing">
		<div class="footer-content">
			<p>
				<a href="http://electricbookworks.com" title="Electric Book Works" class="footer-publisher">Electric Book Works</a>
				<a href="/electric-book-workflow/" title="Home: Electric Book Workflow" class="footer-series">Electric Book Workflow</a>
				<a href="0-3-contents.html" title="Contents: " class="footer-book"><em>A Guide to the Electric Book Workflow</em></a>
				<a href="" title="Top: Setting up" class="footer-page">Setting up</a>
			</p>
		</div><!--.footer-content-->
	</div><!--#footer-->

	
</body>
</html>


