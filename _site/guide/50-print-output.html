<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
	<title>A guide to the Electric Book Workflow: Print output</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" media="screen" href="/css/web-guide.css" />
	<link rel="stylesheet" type="text/css" media="print" href="../css/print-guide.css" />
</head>
<body class="chapter">


		<div id="nav-bar" class="non-printing">
			<p>
				<a href="/" title="Home: Electric Book Workflow" class="nav-series">Electric Book Workflow</a>
				<a href="0-3-contents.html" title="Contents: A guide to the Electric Book Workflow" class="nav-book">A guide to the Electric Book Workflow</a>
				<a href="" title="Top: Print output"  class="nav-page">Print output</a>
			</p>
		</div><!--#nav-bar-->

	<div id="wrapper">


<h1 class="no_toc" id="print-output">Print output</h1>

<ul id="markdown-toc">
  <li><a href="#creating-pdf-files-with-the-prince-gui" id="markdown-toc-creating-pdf-files-with-the-prince-gui">Creating PDF files with the Prince GUI</a></li>
  <li><a href="#refining-print-layout" id="markdown-toc-refining-print-layout">Refining print layout</a>    <ul>
      <li><a href="#faster-print-refinement" id="markdown-toc-faster-print-refinement">Faster print refinement</a></li>
    </ul>
  </li>
  <li><a href="#managing-hyphenation-in-prince" id="markdown-toc-managing-hyphenation-in-prince">Managing hyphenation in Prince</a></li>
</ul>

<p>We use <a href="http://princexml.com/">PrinceXML</a> to turn Jekyll’s HTML into beautiful, print-ready book files. We haven’t found anything as good as Prince, so we reckon it’s worth its price tag. And you can use the trial version to get your print output perfect before committing to the price. So our CSS files for print are designed specifically for Prince.</p>

<p>If you want to learn about using CSS to control print output using Prince, <a href="http://www.smashingmagazine.com/2015/01/designing-for-print-with-css/">this is a great tutorial</a>.</p>

<h2 id="creating-pdf-files-with-the-prince-gui">Creating PDF files with the Prince GUI</h2>

<ol>
  <li>Find your book’s HTML files in your <code class="highlighter-rouge">_site</code> folder. (Remember to run Jekyll locally to generate the latest version; if you’re getting your HTML from a GitHub repo’s <code class="highlighter-rouge">_site</code> folder, trust that the last contributor synced up-to-date, reliable HTML generated by their local Jekyll instance.)</li>
  <li>Drag the HTML files into Prince. Make sure they’re in the right order. Only include the files you need in print. For instance, you’ll usually leave out <code class="highlighter-rouge">index.html</code>. You’ll usually only include <code class="highlighter-rouge">cover.html</code> when creating a PDF ebook.</li>
  <li>Tick ‘Merge all…’ and <strong>specify an output file</strong> location and name. Do not let Prince output to your <code class="highlighter-rouge">_site</code> folder. (If you skip this, Prince will output to your <code class="highlighter-rouge">_site</code> folder, which will cause permissions issues when you want to modify or delete the file, because Jekyll owns the <code class="highlighter-rouge">_site</code> folder and can overwrite it, and because Git will try to commit and sync the output PDF, which you probably don’t want.)</li>
  <li>Prince will find your book’s print CSS, which you specified in <code class="highlighter-rouge">_config.yml</code>. If you want a PDF with a completely different CSS file, either:
    <ul>
      <li>change it in <code class="highlighter-rouge">_config.yml</code> and restart Jekyll to update your files with the new config, or</li>
      <li>leave it blank (<code class="highlighter-rouge">stylesheet-print: ""</code>) and manually add the output CSS to Prince.</li>
    </ul>
  </li>
  <li>To remove crop marks or to remove bleed entirely, add one of these CSS files to Prince (they’re also in <code class="highlighter-rouge">_site/css</code>):
    <ul>
      <li><code class="highlighter-rouge">print-no-crop-marks.css</code> (removes the crop marks, but leaves the bleed as is)</li>
      <li><code class="highlighter-rouge">print-no-bleed.css</code> (removes the bleed, and any crop marks with it).</li>
    </ul>
  </li>
  <li>Click Convert.</li>
</ol>

<blockquote>
  <p>Tech detail: Our default HTML <code class="highlighter-rouge">head</code> includes links to both the screen stylesheet and the print stylesheet specified in <code class="highlighter-rouge">_config.yml</code>. Prince knows which one to use because they’re specified with <code class="highlighter-rouge">media="screen"</code> and <code class="highlighter-rouge">media="print"</code>.</p>
</blockquote>

<h2 id="refining-print-layout">Refining print layout</h2>

<p>You will doubtless want to refine your print layout by editing your markdown and adding custom CSS to your print <code class="highlighter-rouge">.scss</code> file.</p>

<p>For instance, to save widows and orphans, when using the Classic theme, you can tighten letter-spacing by adding <code class="highlighter-rouge"><span class="p">{</span><span class="err">:.tighten</span><span class="p">}</span></code> and <code class="highlighter-rouge"><span class="p">{</span><span class="err">:.loosen</span><span class="p">}</span></code> tags to the lines after paragraphs.</p>

<p>And to add manual hyphens to improve spacing, use discretionary hyphens (aka soft hyphens) by adding the HTML entity <code class="highlighter-rouge">&amp;shy;</code> where you want the soft hyphen.</p>

<h3 id="faster-print-refinement">Faster print refinement</h3>

<p>When refining print layout (e.g. fixing widows and orphans) with the EBWorkflow, this is happening:</p>

<ol>
  <li>You edit the markdown</li>
  <li>Jekyll generates new HTML</li>
  <li>You convert to PDF in Prince</li>
  <li>You open the new PDF to see your changes.</li>
</ol>

<p>There are two delays in this process:</p>

<ol>
  <li>Jekyll can take several seconds to regenerate the entire book (even with <code class="highlighter-rouge">--incremental</code> enabled)</li>
  <li>You have to click ‘Convert’ and Prince must regenerate the file(s)</li>
  <li>If your PDF viewer locks the file you’re viewing, you have to close it before generating a new PDF in Prince.</li>
</ol>

<p>To speed this up:</p>

<ol>
  <li>Temporarily stop Jekyll generating any files you aren’t working on:
    <ul>
      <li>In <code class="highlighter-rouge">_config.yml</code>, add a line that excludes those files. In this example, I’ve listed the CSS folder and all my book’s chapters, and them commented out with <code class="highlighter-rouge">#</code> the one I’m working on, so that Jekyll does regenerate that:</li>
    </ul>

    <p>~~~
 # Jekyll will ignore these files and folders. 
 # Useful for temporarily speeding up processing for particular files.
 exclude: [
 css,
 book-one/0-0-cover.md, 
 book-one/0-1-half-title.md, 
 book-one/0-2-titlepage.md, 
 book-one/0-3-copyright.md,
 book-one/0-4-contents.md,
 #book-one/1.md,
 book-one/2.md,
 book-one/3.md,
 ]
 ~~~</p>
  </li>
  <li>Using the Prince GUI there isn’t a universal way to speed up conversion. Depending on your setup, you might look into using the command line instead, or making sure you’ve disabled any unnecessary Javascript.</li>
  <li>Use a PDF Viewer that <a href="http://superuser.com/questions/599442/pdf-viewer-that-handles-live-updating-of-pdf-doesnt-lock-the-file">doesn’t lock the file</a>. On Windows, <a href="http://www.sumatrapdfreader.org/free-pdf-reader.html">Sumatra</a> is perfect for this, unlike Acrobat and Windows Preview, which locks the file. If you edit/regenerate a PDF it has open, Sumatra will allow that to happen and will automatically reload the new file, at the same page you had open. We believe Mac Preview does the same, though we haven’t tested it.</li>
</ol>

<h2 id="managing-hyphenation-in-prince">Managing hyphenation in Prince</h2>

<p>Our default stylesheets ask Prince to hyphenate paragraphs and lists (<code class="highlighter-rouge">p, ul, ol, dl</code>), with a few exceptions (such as text on the title and contents pages). Prince includes a range of hyphenation dictionaries by default, which do a good job. However, you might need to add dictionaries or lists of specific words that Prince doesn’t support. You can find <code class="highlighter-rouge">.dic</code> files online for <a href="http://www.ctan.org/tex-archive/language/hyph-utf8/tex/generic/hyph-utf8/patterns/txt">various languages</a> and specialities, or you can compile your own.</p>

<p>We provide a blank <code class="highlighter-rouge">.dic</code> file for you to add your own list of hyphenation rules to. It is at <code class="highlighter-rouge">css/dictionaries/hyph.dic</code>. Our <code class="highlighter-rouge">print.css</code> asks Prince to look here when hyphenating.</p>

<p>A <code class="highlighter-rouge">.dic</code> file is a plain-text file with one word or word-fragment on each line. Each one is called a pattern.</p>

<ul>
  <li>If the pattern starts with a <code class="highlighter-rouge">.</code>, it will apply to, or match, any word that starts with that pattern. E.g. <code class="highlighter-rouge">.foo</code> will match the words ‘food’ and ‘foobar’ but not ‘fastfood’.</li>
  <li>If the pattern ends with a <code class="highlighter-rouge">.</code>, it will apply to any word that ends with that pattern. E.g. <code class="highlighter-rouge">port.</code> will match ‘port’ and ‘sport’ but not ‘portico’.</li>
  <li>Thus, if the pattern starts <em>and</em> ends with a <code class="highlighter-rouge">.</code>, it will apply to only that pattern exactly. E.g. <code class="highlighter-rouge">.port.</code> will only ever match ‘port’.</li>
</ul>

<p>To show where a word or word-fragment can hyphenate, you add digits (1 to 9) to the pattern. The digits have special meanings:</p>

<ul>
  <li>Insert odd digits (1, 3, 5, 7, 9) where the word may hyphenate.</li>
  <li>Insert even digits (2, 4, 6, 8) where the word should not hyphenate.</li>
  <li>The higher the number, the more important the rule. That is, a <code class="highlighter-rouge">1</code> says ‘hyphenate here if you must’, but a <code class="highlighter-rouge">9</code> says ‘this is the best place to hyphenate’. A 2 says ‘don’t hyphenate here if you can help it’, but an <code class="highlighter-rouge">8</code> says ‘Do not, not, not hyphenate here.’</li>
</ul>

<p>For user discussion, see <a href="http://www.princexml.com/forum/topic/542/prince-hyphenate-patterns-none-url-patterns-url">the Prince forums here</a>: If you need to hack Prince’s built-in hyphenation dictionaries more deeply, see <a href="http://www.princexml.com/forum/topic/1474/prince-and-hyphenation">this forum post</a>.</p>


	</div><!--#wrapper-->
	

	<div id="footer" class="non-printing">
		<div class="footer-content">
			<p>
				<a href="http://electricbookworks.com" title="Electric Book Works" class="footer-publisher">Electric Book Works</a>
				<a href="/" title="Home: Electric Book Workflow" class="footer-series">Electric Book Workflow</a>
				<a href="0-3-contents.html" title="Contents: A guide to the Electric Book Workflow" class="footer-book"><em>A guide to the Electric Book Workflow</em></a>
				<a href="" title="Top: Print output" class="footer-page">Print output</a>
			</p>
		</div><!--.footer-content-->
	</div><!--#footer-->

	
</body>
</html>

